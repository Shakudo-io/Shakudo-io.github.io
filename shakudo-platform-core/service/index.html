<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-shakudo-platform-core/service">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Shakudo Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Shakudo Docs Atom Feed"><title data-rh="true">Microservices | Shakudo Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/shakudo-platform-core/service"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Microservices | Shakudo Docs"><meta data-rh="true" name="description" content="Shakudo Microservices are non-terminating jobs with an exposed endpoint. Services are only available from within the cluster by default, but can also be reached externally using a JWT (explained below)."><meta data-rh="true" property="og:description" content="Shakudo Microservices are non-terminating jobs with an exposed endpoint. Services are only available from within the cluster by default, but can also be reached externally using a JWT (explained below)."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/shakudo-platform-core/service"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/shakudo-platform-core/service" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/shakudo-platform-core/service" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ce3a0bdd.css">
<link rel="preload" href="/assets/js/runtime~main.ed7dd1c6.js" as="script">
<link rel="preload" href="/assets/js/main.1817e075.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/home"><div class="navbar__logo"><img src="/img/logo.svg" alt="Shakudo logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Shakudo logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Shakudo Docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/home">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/devsentient/examples" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/home">Welcome to Shakudo</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/getting-started">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/category/shakudo-platform">Shakudo Platform</a><button aria-label="Toggle the collapsible sidebar category &#x27;Shakudo Platform&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/sessions">Sessions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Sessions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/shakudo-platform-core/jobs">Jobs and Triggers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/shakudo-platform-core/service">Microservices</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/category/admin-settings">Admin Settings</a><button aria-label="Toggle the collapsible sidebar category &#x27;Admin Settings&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/shakudo-platform-core/customImageSecret/k8s-serviceaccount-ecr-secret">customImageSecret</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed hidden"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/shakudo-stack-components">Shakudo Stack Components</a><button aria-label="Toggle the collapsible sidebar category &#x27;Shakudo Stack Components&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/tutorials">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/legacy/public-logo-cdn-setup">Legacy</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/category/shakudo-platform"><span itemprop="name">Shakudo Platform</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Microservices</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Microservices</h1><p>Shakudo Microservices are non-terminating jobs with an exposed endpoint. Services are only available from within the cluster by default, but can also be reached externally using a JWT (explained below).
Services are the best way to make an application available or to enable real-time data processing or streaming applications on Shakudo.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-microservice">Creating a Microservice<a class="hash-link" href="#creating-a-microservice" title="Direct link to heading">​</a></h2><p>Services can be created from the Shakudo landing page by clicking the &quot;start a service&quot; button.</p><p><img loading="lazy" alt="Start a service" src="/assets/images/homepage_start_service-384b3451ff23debe3b88aea5fded174b.png" width="1466" height="572" class="img_ev3q"></p><p>Alternatively, services can be created from the service page by clicking &quot;create service&quot;.</p><p><img loading="lazy" alt="Start a service" src="/assets/images/service_start_service-9ba7f7510fc05159104dc42206d646fc.png" width="2768" height="756" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="basic-settings">Basic settings<a class="hash-link" href="#basic-settings" title="Direct link to heading">​</a></h3><p>A basic service can be started by simply providing the service name (automatically generated by default), the desired service endpoint, an environment configuration (which work the same way as in Shakudo <a href="https://docs.shakudo.io/shakudo-platform-core/sessions/" target="_blank" rel="noopener noreferrer">Sessions</a>), and a path to the service configuration YAML file, relative to the git repository associated with the service (configurable in the advanced tab)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-settings">Advanced settings<a class="hash-link" href="#advanced-settings" title="Direct link to heading">​</a></h3><p>The advanced tab allows configuring some more advanced service parameters, described in the table below:</p><table><thead><tr><th align="left">Name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">Port</td><td align="left">Enter a port to expose between 1 and 65535. The default for Shakudo Platform services is port 8787.</td></tr><tr><td align="left">Min Replicas</td><td align="left">Minimum amount of replicas running the service simultaneously</td></tr><tr><td align="left">Max Replicas</td><td align="left">Maximum amount of replicas running the service simultaneously</td></tr><tr><td align="left">Git repository</td><td align="left">The git repository associated with the service</td></tr><tr><td align="left">Branch</td><td align="left">Git branch name for the service</td></tr><tr><td align="left">Commit</td><td align="left">Git commit ID hash to use for the service</td></tr></tbody></table><p>The git repository, branch and commit will be used to clone a project into the service environment, and the service YAML will be located and run from the root of the cloned project.</p><p>Additional arbitrary parameters for the service runner configuration can be set in the Parameters tab. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="parameters">Parameters<a class="hash-link" href="#parameters" title="Direct link to heading">​</a></h3><p>Similarly to Jobs, you can add Parameters to inject some additional information, which you can use in your code. When you attach Parameters, they will be available as environment variables, in upper case, with all non-alphanumeric characters replaced by <code>_</code>. For example, if you add an parameter with name &quot;model-name&quot;, it will be accessible as the <code>MODEL_NAME</code> in the Service&#x27;s environment variables. </p><p>To maintain backward compatibility with legacy services, Parameters are also available with the <code>HYPERPLANE_JOB_PARAMETER_</code>. Using the example above, this would be <code>HYPERPLANE_JOB_PARAMETER_MODEL_NAME</code>. </p><p>Note that these values are stored in plain text, it&#x27;s recommended that you use Secrets for API keys, keyfile strings, access credentials, and other secret values.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="secrets">Secrets<a class="hash-link" href="#secrets" title="Direct link to heading">​</a></h3><p>When you attach Secrets, they will be available both as environment variables and as a file. </p><p>In the case of environment variable, the secret key will be converted to upper case, with all non-alphanumeric characters replaced by <code>_</code>, and prefixed with <code>HYPERPLANE_CUSTOM_SECRET_KEY_</code>. For example, if you add an parameter with name &quot;openai-key&quot;, it will be accessible as the <code>HYPERPLANE_CUSTOM_SECRET_KEY_OPENAI_KEY</code> in the Service&#x27;s environment variables. </p><p>Secrets are available as files, in the format of <code>/etc/hyperplane/secrets/{secret_name}/{secret_key}</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="starting-with-a-bash-script">Starting with a bash script<a class="hash-link" href="#starting-with-a-bash-script" title="Direct link to heading">​</a></h3><p>If you only need to run a single step consisting of a bash script to start your app, select &quot;Shell&quot; instead of &quot;Multi-step&quot; in the Job creation dialogue. </p><p><img loading="lazy" alt="Microservice with bash script" src="/assets/images/job_with_bash_script-9a81fd3dd12bd255cfd5f26c3cf5dc86.png" width="1200" height="749" class="img_ev3q"></p><p>As you would for multi-step pipeline YAMLs, specify the path to the bash script relative to the root of your git repo.</p><p>An example bash script might look like the following:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set -e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROJECT_DIR=&quot;$(cd -P &quot;$(dirname &quot;${BASH_SOURCE[0]}&quot;)&quot; &amp;&amp; pwd)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd &quot;$PROJECT_DIR&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install foo-package==bar-version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python ./app.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note the shebang for bash. The <code>-e</code> flag detects errors in the currently running script, and stops the script when one of the commands within returns a non-zero status. <code>PROJECT_DIR</code> finds the current directory of the current bash script. It is useful when you want to reference things relative to the current bash script. </p><p>This bash script will start your Microservice (e.g. a Flask app) and run until app.py exits with an error. In the case of an error, the pod will be restarted and the script will rerun from the top.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="subdomains-and-exposing-endpoints">Subdomains and exposing endpoints<a class="hash-link" href="#subdomains-and-exposing-endpoints" title="Direct link to heading">​</a></h3><p>The recommended approach is to use Subdomains rather than sub-paths for each application. In versions of Shakudo 3.47.0 and later, Microservices with subdomains that end in &quot;-public&quot; or &quot;-webhook&quot; will be publicly exposed to users who are not logged in, acting as webhooks. We recommend using our random URL generator to protect your webhooks endpoints. </p><p><img loading="lazy" alt="Microservice Webhook" src="/assets/images/microservice-webhook-422eebf4767bae4b7864eb7e11d01981.png" width="3128" height="1320" class="img_ev3q"> </p><p>If you already have a running service and would like to open up a separate URL, you can use the Traffic Shifter to create a webhook for an existing Microservice.</p><p><img loading="lazy" alt="Traffic Shifter Webhook" src="/assets/images/traffic-shifter-webhook-bf2f11b1b2021343b0b5ff7ce10c95fd.png" width="2984" height="1100" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="logs-and-filtering">Logs and filtering<a class="hash-link" href="#logs-and-filtering" title="Direct link to heading">​</a></h3><p>To view the live logs for a Microservice, go to the Microservices table view and select the logs icon for the live logs modal. If you would like to view historical logs, you can click the Grafana icon in the table entry.
<img loading="lazy" alt="Microservices Logs" src="/assets/images/microservices-logs-d9e982cedee1af48360bf72d25c3b0a4.png" width="2702" height="696" class="img_ev3q"> </p><p>The Grafana dashboard is automatically filtered for the Microservice by id. To see logs for a specific service name rather than id, you can use a filter like <code>{hyperplane_dev_app_name=&quot;test-recycle&quot;}</code> in the Grafana dashboard. </p><p><img loading="lazy" alt="Grafana Filter By App Name" src="/assets/images/grafana-filter-by-app-name-20689f2bb4bcea6c31cb2266f2a26a54.png" width="3148" height="1802" class="img_ev3q"> </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="customize-pod-yaml">Customize Pod YAML<a class="hash-link" href="#customize-pod-yaml" title="Direct link to heading">​</a></h3><p>Customize Pod YAML is an option for advanced users who are familiar with Kubernetes and want to manipulate the specs of a Microservice at a more granular level. The screen starts off with the YAML generated from the Create a Microservice form, but you can edit any of the fields. There is a validation check to ensure that the fields are Kubernetes compatible.</p><p><img loading="lazy" alt="Custom YAML Icon" src="/assets/images/custom-yaml-icon-cb7cf539d696c0a829f46e4e1263206f.png" width="3046" height="1256" class="img_ev3q"></p><p>For previously-created services, if you want to compare the differences between the custom YAML used vs. the auto-generated YAML, you can click on the &quot;Customized YAML&quot; on the Microservice Details page to see a side-by-side comparison.</p><p><img loading="lazy" alt="Custom YAML Diff" src="/assets/images/custom-yaml-diff-9afb4416025ff2c97aaedb43283c2c2d.png" width="3392" height="1776" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="service-actions">Service actions<a class="hash-link" href="#service-actions" title="Direct link to heading">​</a></h2><p>The service actions menu can be used to operate on a current or past service.</p><p><img loading="lazy" alt="Service actions" src="/assets/images/service_actions-0dea86a0f09f18e7f1046d10600ba8b1.png" width="286" height="400" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cancel">Cancel<a class="hash-link" href="#cancel" title="Direct link to heading">​</a></h3><p>A current service can be canceled by choosing the &quot;cancel&quot; action in the action menu.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="clone">Clone<a class="hash-link" href="#clone" title="Direct link to heading">​</a></h3><p>A new service can be created based on the configuration of an existing service by choosing the &quot;clone&quot; action. This can also be used on past services that have been canceled to recreate a service of the same type, or to use the service settings as a template for faster iteration.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="restart">Restart<a class="hash-link" href="#restart" title="Direct link to heading">​</a></h3><p>Restarting a service (which will cause it to pull from the associated repository as per its settings) can be done by selecting the &quot;restart&quot; action.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="edit">Edit<a class="hash-link" href="#edit" title="Direct link to heading">​</a></h3><p>If you are on a version of Shakudo that supports editing Microservices and you have permissions to change a specific Microservice, you will see &quot;Edit&quot; in the dropdown. Editing most values, other than the README, will result in a microservice restart upon saving.</p><p>If your Shakudo version does not yet support a single-action update operation on Microservices, the recommended path to updating specific values are to first stop the existing service and then clone it, with an updated configuration. For updates to the service code from the associated repository which don&#x27;t require configuration changes, the Microservice should be restarted with the restart action.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-a-service-from-outside-the-cluster">Accessing a service from outside the cluster<a class="hash-link" href="#accessing-a-service-from-outside-the-cluster" title="Direct link to heading">​</a></h2><p>Creating webhooks using the Traffic Shifter is a standard way to expose a Shakudo Microservice publicly. However, if you prefer not to use webhooks, Microservices can be accessed externally using a JWT using the bearer method in the request headers.</p><ul><li>Prepare to make a <code>POST</code> request to <code>https://{your_shakudo_domain}/auth/realms/{realm_name}/protocol/openid-connect/token</code>, for example using <code>curl</code> or <code>Postman</code><ul><li><code>{your_shakudo_domain}</code> is the domain at which your Keycloak is available, which is usually the same domain at which you access your cluster running Shakudo</li><li>You must know your <code>{realm_name}</code> to obtain the JWT.</li></ul></li><li>Set the <code>Content-Type</code> header to <code>application/x-www-form-urlencoded</code></li><li>Set the following parameters in the request body:<ul><li><code>client_id</code>: the client used to get the token (probably <code>istio</code>)</li><li><code>grant_type</code>: value should be <code>password</code></li><li><code>username</code>: Your username</li><li><code>password</code>: Your password</li></ul></li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The Access Type must be public to obtain a JWT this way</p></div></div><p>The response JWT can then be used to access service endpoints: simply add <code>Authorization: Bearer {token}</code> to your Headers, with <code>{token}</code> being the JWT obtained in the previous step.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="health-check">Health Check<a class="hash-link" href="#health-check" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="liveness-and-readiness-probes">Liveness and Readiness Probes<a class="hash-link" href="#liveness-and-readiness-probes" title="Direct link to heading">​</a></h3><p>In versions v3.48.0 and later of Shakudo, you can enable &quot;Health Probes&quot; through the Microservice creation page. By default, enabling Health Probes through the dashboard adds a simple TCP socket probe, using the value in your <code>exposedPort</code>, to your Microservice:</p><p><img loading="lazy" alt="Health Probes" src="/assets/images/health-probes-b3d08e51ab2dd76aa46d7ab75e30d4bb.png" width="2230" height="1190" class="img_ev3q"></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    livenessProbe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tcpSocket:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: 8787</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      initialDelaySeconds: 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      periodSeconds: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      timeoutSeconds: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      failureThreshold: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    readinessProbe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tcpSocket:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: 8787</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      initialDelaySeconds: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      periodSeconds: 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      timeoutSeconds: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      failureThreshold: 3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you wish to modify to a more advanced health probe, you can go to the Custom YAML panel to add further customizations. For example, to add a probe checking a /health endpoint, you can use the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    livenessProbe:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      httpGet:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        path: /healthz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        port: 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        httpHeaders:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        - name: Custom-Header</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          value: Awesome</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      initialDelaySeconds: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      periodSeconds: 3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For more options, refer to the <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/" target="_blank" rel="noopener noreferrer">Kubernetes official docs for probes</a>. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="check-all-services-as-an-admin">Check All Services as an Admin<a class="hash-link" href="#check-all-services-as-an-admin" title="Direct link to heading">​</a></h3><p>Once deployed, you can confirm the Microservice is healthy using the k9s or Cluster Shell (if you have a dashboard-admin role). </p><hr><h1>Example: Neo4j Streamlit Microservice</h1><p>This example demonstrates how to deploy a simple Streamlit application that connects to a Neo4j database and provides a real-time query interface with the following features:</p><ul><li>Interactive frontend built with Streamlit</li><li>Connects to Neo4j using the official Python driver</li><li>Visualizes Cypher query results in an intuitive, user-friendly graph interface</li><li>Fully configurable via environment variables (URI, user, password, etc.)</li><li>Includes a setup and usage screen recording</li></ul><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="setup-instructions">Setup Instructions<a class="hash-link" href="#setup-instructions" title="Direct link to heading">​</a></h2><ol><li><p><strong>Add the repository</strong> to your Shakudo workspace.</p><p><img loading="lazy" alt="Add git repo" src="/assets/images/link_git_repo-1637de2707a2333931f1a16c04061a1a.png" width="2134" height="1129" class="img_ev3q"></p></li><li><p><strong>Create a new Microservice</strong> using either the landing page or the service dashboard.</p></li><li><p><strong>Set Service Details</strong>:</p><ul><li><p><strong>Name</strong> your service:<br>
<!-- -->Example: <code>neo4j-streamlit</code></p></li><li><p><strong>Subdomain</strong> (optional but recommended):<br>
<!-- -->Set it to match the name, e.g. <code>neo4j-streamlit</code>, which will expose the service at:<br>
<code>neo4j-streamlit.test-dev.canopyhub.io</code></p></li><li><p><strong>Port</strong>:<br>
<!-- -->Use the default port: <code>8787</code></p></li><li><p><strong>Environment Config</strong>:<br>
<!-- -->Select <code>Basic</code> (or another appropriate Environment Config that includes Python)</p></li><li><p><strong>Pipeline</strong>:<br>
<!-- -->Choose the <strong>Shell</strong> option<br>
<!-- -->Provide the relative path to your shell script, for example:<br>
<code>neo4j-microservice/run.sh</code><br>
<!-- -->This script should exist in your Git repository and be executable.</p></li><li><p><strong>Git Repository</strong>:</p><ul><li>Select repository: <code>shakudo-examples</code></li><li>Branch: <code>feature/neo4j-streamlit</code></li></ul></li></ul><p><img loading="lazy" alt="Microservice config" src="/assets/images/microservice_config-c6bbdf19e6159e660c76c63c9fa1f096.png" width="2760" height="2248" class="img_ev3q"></p></li></ol><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="parameters-1">Parameters<a class="hash-link" href="#parameters-1" title="Direct link to heading">​</a></h2><p>Add the following <strong>Parameters</strong> (not Secrets unless sensitive):</p><table><thead><tr><th>Parameter Name</th><th>Description</th><th>Example Value</th></tr></thead><tbody><tr><td><code>NEO4J_URI</code></td><td>Bolt connection URI for Neo4j</td><td><code>bolt://neo4j.hyperplane-neo4j.svc.cluster.local:7687</code></td></tr><tr><td><code>NEO4J_USER</code></td><td>Neo4j username</td><td><code>neo4j</code></td></tr><tr><td><code>NEO4J_PASSWORD</code></td><td>Neo4j password</td><td><code>your_secure_password</code> (use a Secret for real deployments)</td></tr></tbody></table><p>These will be available inside the service as environment variables:<br>
<!-- -->e.g., <code>NEO4J_URI</code>, <code>NEO4J_USER</code>, <code>NEO4J_PASSWORD</code></p><p><img loading="lazy" alt="Microservice config" src="/assets/images/microservice_parameters-bc5bedfc0e8b1d1ee0860a66ca26700d.png" width="3058" height="1318" class="img_ev3q"></p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="streamlit-app-preview">Streamlit app preview<a class="hash-link" href="#streamlit-app-preview" title="Direct link to heading">​</a></h2><p><img loading="lazy" alt="Streamlit app preview" src="/assets/images/streamlit-35148e79a7fb7b89aeff1b9d545f5f8b.png" width="2000" height="1169" class="img_ev3q"></p><hr><p><strong>Watch Setup Demo</strong> —
Watch the setup demo <a target="_blank" href="/assets/files/connect-neo4j-to-streamlit-3944d4da43e05204a95ab9f437a94d8b.mp4">here</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vbeJ"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-09-23T21:35:16.000Z">9/23/2025</time></b> by <b>Yijie</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/shakudo-platform-core/jobs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Jobs and Triggers</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/category/admin-settings"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Admin Settings</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#creating-a-microservice" class="table-of-contents__link toc-highlight">Creating a Microservice</a><ul><li><a href="#basic-settings" class="table-of-contents__link toc-highlight">Basic settings</a></li><li><a href="#advanced-settings" class="table-of-contents__link toc-highlight">Advanced settings</a></li><li><a href="#parameters" class="table-of-contents__link toc-highlight">Parameters</a></li><li><a href="#secrets" class="table-of-contents__link toc-highlight">Secrets</a></li><li><a href="#starting-with-a-bash-script" class="table-of-contents__link toc-highlight">Starting with a bash script</a></li><li><a href="#subdomains-and-exposing-endpoints" class="table-of-contents__link toc-highlight">Subdomains and exposing endpoints</a></li><li><a href="#logs-and-filtering" class="table-of-contents__link toc-highlight">Logs and filtering</a></li><li><a href="#customize-pod-yaml" class="table-of-contents__link toc-highlight">Customize Pod YAML</a></li></ul></li><li><a href="#service-actions" class="table-of-contents__link toc-highlight">Service actions</a><ul><li><a href="#cancel" class="table-of-contents__link toc-highlight">Cancel</a></li><li><a href="#clone" class="table-of-contents__link toc-highlight">Clone</a></li><li><a href="#restart" class="table-of-contents__link toc-highlight">Restart</a></li><li><a href="#edit" class="table-of-contents__link toc-highlight">Edit</a></li></ul></li><li><a href="#accessing-a-service-from-outside-the-cluster" class="table-of-contents__link toc-highlight">Accessing a service from outside the cluster</a></li><li><a href="#health-check" class="table-of-contents__link toc-highlight">Health Check</a><ul><li><a href="#liveness-and-readiness-probes" class="table-of-contents__link toc-highlight">Liveness and Readiness Probes</a></li><li><a href="#check-all-services-as-an-admin" class="table-of-contents__link toc-highlight">Check All Services as an Admin</a></li></ul></li><li><a href="#setup-instructions" class="table-of-contents__link toc-highlight">Setup Instructions</a></li><li><a href="#parameters-1" class="table-of-contents__link toc-highlight">Parameters</a></li><li><a href="#streamlit-app-preview" class="table-of-contents__link toc-highlight">Streamlit app preview</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.com/invite/shakudo" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/shakudo_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/devsentient/examples" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Shakudo Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ed7dd1c6.js"></script>
<script src="/assets/js/main.1817e075.js"></script>
</body>
</html>